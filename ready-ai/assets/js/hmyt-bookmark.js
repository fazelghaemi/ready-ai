jQuery(document).ready(function(e){let t=hmytBookmarkVars;function o(e,o){let s=e.find("svg path");if(o?(s.css("fill",t.fill_color),s.css("stroke",t.fill_color)):(s.css("fill","none"),s.css("stroke",t.stroke_color)),"icon_text"===t.button_display){let a=e.find(".hmyt-bookmark-label-text");a.length&&a.text(o?t.toast_messages.remove_text:t.toast_messages.add_text)}}e(".hmyt-bookmark-button").each(function(){let s=e(this),a=s.data("post-id"),r=t.is_logged_in&&t.user_bookmarks.includes(a);o(s,r)}),e(document).on("click",".hmyt-bookmark-button",function(s){s.preventDefault();let a=e(this),r=a.data("post-id");if(!t.is_logged_in){toast.error(t.toast_messages.login_required),"1"===t.enable_redirect&&t.redirect_url&&setTimeout(()=>{toast.loading(t.toast_messages.redirecting),setTimeout(()=>{window.location.href=t.redirect_url},1500)},1e3);return}let n=toast.loading(t.toast_messages.saving);e.ajax({url:t.ajax_url,type:"POST",data:{action:"hmyt_toggle_bookmark",post_id:r,nonce:t.nonce},success:function(s){toast.closeLoading(n),s.success?(s.data.bookmarked?toast.success(t.toast_messages.success_add):toast.success(t.toast_messages.success_remove),t.user_bookmarks=s.data.bookmarks,e('.hmyt-bookmark-button[data-post-id="'+r+'"]').each(function(){o(e(this),s.data.bookmarked)})):toast.error(s.data.message||"خطایی رخ داد.")},error:function(){toast.closeLoading(n),toast.error("خطای ارتباط با سرور.")}})}),e(document).on("click",".item-bookmark-delete",function(s){s.preventDefault();let a=e(this),r=a.data("id"),n=a.closest(".panel-bookmark-item"),i=toast.loading(t.toast_messages.removing);e.ajax({url:t.ajax_url,type:"POST",data:{action:"hmyt_remove_bookmark",post_id:r,nonce:t.nonce},success:function(s){toast.closeLoading(i),s.success?(toast.success(t.toast_messages.removed),n.fadeOut(300,function(){e(this).remove(),0===e("#hmyt-bookmark-list-container .panel-bookmark-item").length&&e("#hmyt-bookmark-list-container").html('<div class="hmyt-alert hmyt-alert-success">لیست علاقه‌مندی‌های شما خالی است.</div>')}),t.user_bookmarks=t.user_bookmarks.filter(e=>e!==r),e('.hmyt-bookmark-button[data-post-id="'+r+'"]').each(function(){o(e(this),!1)})):toast.error(s.data.message||"خطایی در حذف آیتم رخ داد.")},error:function(){toast.closeLoading(i),toast.error("خطای ارتباط با سرور.")}})})});