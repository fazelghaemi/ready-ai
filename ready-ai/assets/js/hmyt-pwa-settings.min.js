// developed by web-premium.ir
jQuery(document).ready(function(t) {
    t(".nav-tab").on("click", function(e) {
        e.preventDefault(),
        t(".nav-tab").removeClass("nav-tab-active"),
        t(this).addClass("nav-tab-active"),
        t(".tab-content").removeClass("active"),
        t(t(this).attr("href")).addClass("active")
    }),
    t("#hmyt_enable_pwa_switch .hmyt-switch-item").on("click", function() {
        t(this).closest(".hmyt-switch-toggle").find(".hmyt-switch-item").removeClass("item-selected"),
        t(this).addClass("item-selected");
        var e = t(this).data("value");
        t("#hmyt_enabled").val(e),
        t("#pwa_config").toggleClass("hmyt-hidden", !e)
    }),
    t("#hmyt_pwa_popup_enable_switch .hmyt-switch-item").on("click", function() {
        t(this).closest(".hmyt-switch-toggle").find(".hmyt-switch-item").removeClass("item-selected"),
        t(this).addClass("item-selected");
        var e = t(this).data("value");
        t("#hmyt_pwa_popup_enabled").val(e),
        t("#hmyt_pwa_popup_frequency_wrapper").toggleClass("hmyt-hidden", !e)
    }),
    t("#hmyt_start_url_mode").on("change", function() {
        "custom_page" === t(this).val() ? t("#hmyt_custom_start_page_wrapper").slideDown() : t("#hmyt_custom_start_page_wrapper").slideUp()
    }),
    t("#hmyt-pwa-settings-form").on("submit", function(e) {
        e.preventDefault();
        var a = t("#hmyt_save_general_settings");
        a.val();
        var s = toast.loading("در حال پردازش...");
        a.prop("disabled", !0).css("opacity", "0.6"),
        t.ajax({
            url: hmytAjax.ajaxurl,
            type: "POST",
            data: {
                action: "hmyt_save_general_settings",
                nonce: t("#hmyt_settings_nonce").val(),
                hmyt_enabled: t("#hmyt_enabled").val(),
                hmyt_app_name: t("#hmyt_app_name").val(),
                hmyt_short_name: t("#hmyt_short_name").val(),
                hmyt_icon: t("#hmyt_icon").val(),
                hmyt_theme_color: t("#hmyt_theme_color").val(),
                hmyt_background_color: t("#hmyt_background_color").val(),
                hmyt_orientation: t("#hmyt_orientation").val(),
                hmyt_start_url_mode: t("#hmyt_start_url_mode").val(),
                hmyt_custom_start_page_id: t("#hmyt_custom_start_page_id").val(),
                hmyt_pwa_popup_enabled: t("#hmyt_pwa_popup_enabled").val(),
                hmyt_pwa_popup_frequency: t("#hmyt_pwa_popup_frequency").val(),
                hmyt_pwa_popup_desktop_enabled: t("#hmyt_pwa_popup_desktop_enabled").val()
            },
            success: function(t) {
                toast.closeLoading(s),
                t.success ? toast.success(t.data.message) : toast.error(t.data.message || "خطا در ذخیره تنظیمات."),
                a.prop("disabled", !1).css("opacity", "1")
            },
            error: function(t) {
                toast.closeLoading(s);
                var e = "خطا در ذخیره تنظیمات.";
                t.responseJSON && t.responseJSON.data && t.responseJSON.data.message && (e = t.responseJSON.data.message),
                toast.error(e),
                a.prop("disabled", !1).css("opacity", "1")
            }
        })
    }),
    t("#hmyt_custom_start_page_id").select2({
        placeholder: "برگه مورد نظر را انتخاب کنید...",
        allowClear: !0,
        ajax: {
            url: hmytAjax.ajaxurl,
            dataType: "json",
            delay: 250,
            data: function(t) {
                return {
                    action: "hmyt_get_pages",
                    nonce: hmytAjax.nonce_get_pages,
                    term: t.term
                }
            },
            processResults: function(t) {
                return {
                    results: t.results
                }
            },
            cache: !0
        },
        minimumInputLength: 1,
        templateResult: function(e) {
            return e.loading ? e.text : t("<span>" + e.text + '<br><small style="color:#999;">' + e.url + "</small></span>")
        },
        templateSelection: function(t) {
            return t.text
        }
    })
    t("#hmyt_pwa_popup_enable_switch .hmyt-switch-item").on("click", function() {
        var e = t(this).data("value");
        t("#hmyt_pwa_popup_desktop_wrapper").toggleClass("hmyt-hidden", !e)
    }),
    t("#hmyt_pwa_popup_desktop_enable_switch .hmyt-switch-item").on("click", function() {
        t(this).closest(".hmyt-switch-toggle").find(".hmyt-switch-item").removeClass("item-selected"),
        t(this).addClass("item-selected");
        var e = t(this).data("value");
        t("#hmyt_pwa_popup_desktop_enabled").val(e)
    });
});