jQuery(document).ready(function(e){function i(e,i="block"){e&&e.length&&("none"===e.css("display")&&e.css("display",i),requestAnimationFrame(function(){setTimeout(function(){e.addClass("visible")},20)}))}e(".satisfaction-text .percentage").each(function(){var i;let n;e(this).text((i=e(this).text(),n=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"],i.toString().replace(/\d/g,function(e){return n[e]})))}),e(document).ready(function(){e(".hmyt-ai-review-summary").each(function(){var n=e(this);if(n.addClass("visible"),n.length&&!n.hasClass("has-animated")){n.addClass("has-animated");var t,a,s,c=n.find(".summary-text"),o=c.text().trim();if(o.length>0){let r;c.html("").css("max-height","fit-content"),t=c,a=o,s=function(){"undefined"!=typeof marked&&marked.setOptions({breaks:!0}),c.html(marked.parse(o));var t=n.find(".pros-cons-container"),a=n.find(".pro-item, .con-item"),s=n.find(".disclaimer"),r=n.find(".feedback-container");"yes"===hmyt_ai_vars.disable_typing_animation?(t.length&&(t.css("display","flex").addClass("visible"),a.css("display","inline-flex").addClass("visible")),s.css("display","block").addClass("visible"),r.css("display","flex").addClass("visible")):setTimeout(function(){if(t.length){i(t,"flex");var a=t.length?200:0;n.find(".pro-item, .con-item").each(function(n){var t=e(this);setTimeout(function(){i(t,"inline-flex")},a+100*n+50)})}var c=300;t.length&&n.find(".pro-item").length>0&&(c=100*n.find(".pro-item").length+200),setTimeout(function(){i(s,"block"),setTimeout(function(){i(r,"flex")},300)},c)},300)},"yes"===hmyt_ai_vars.disable_typing_animation?s():(r=0,t.html(""),function e(){r<a.length?("\n"===a.charAt(r)?t.append("<br />"):t.append(a.charAt(r)),r++,setTimeout(e,10)):s&&s()}())}else{c.css("max-height","0px");var l=n.find(".pros-cons-container");l.length&&(i(l,"flex"),n.find(".pro-item, .con-item").each(function(n){var t=e(this);setTimeout(function(){i(t,"inline-flex")},100*n+50)})),i(n.find(".disclaimer"),"block"),i(n.find(".feedback-container"),"flex")}}})}),e(document).on("click",".feedback-btn",function(){var i=e(this),n=i.hasClass("like-btn")?"positive":"negative",t=i.data("product-id")||i.data("post-id"),a=i.closest(".feedback-container").data("summary-type"),s="",c={type:n,summary_type:a,security:hmyt_ai_vars.nonce};"reviews"===a||"description"===a?(s="save_feedback",c.product_id=t):("post_reviews"===a||"post_content"===a)&&(s="save_post_feedback",c.post_id=t),e.ajax({url:hmyt_ai_vars.ajax_url,type:"POST",data:{action:s,...c},success:function(e){e.success?(toast.success(e.data.message),i.addClass("active").siblings(".feedback-btn").removeClass("active")):(toast.error(e.data.message||"خطای ناشناخته در ثبت بازخورد."),e.data.redirect&&"yes"===hmyt_ai_vars.redirect_on_not_logged_in&&hmyt_ai_vars.login_url&&(toast.loading(hmyt_ai_vars.redirect_message),setTimeout(function(){window.location.href=hmyt_ai_vars.login_url},2e3)))},error:function(e,i,n){toast.error("خطا در ارتباط با سرور: "+n),console.error("AJAX Error:",i,n,e)}})})});